# MLP-сеть для классификации графических примитивов
## Что делаем. Краткое описание

*Наиболее вероятное название*: MLP сеть для классификации/распознавания геометрических примитивов
Пользователь создаёт MLP сеть, настраивает слои, моделька обучается и тестируется на датасете/пользовательских картинках. Моделька может создаваться/сохраняться в нашем формате.
## Сеть
- Архитектура: MLP
- Функции активации: relu (prelu), sigmoid, tanh, softmax
- Размер входного слоя: n^2, где n - размер картинки. Активация: -
- Размер выходного слоя: m, где m - число классов (геометрических примитивов). Активация: softmax
- Размер скрытого слоя: произвольный (настраиваемый). Активация: relu/prelu/sigmoid/tanh 
#### Общая схема разработки
- Функции активации - просто глобальные функции в custom'ном namespace
- Нейрон - класс, **атрибуты** - посчитанное значение и функция активации (указатель на одну из namespace)
- Слой - класс (конструктор собирает нейроны), **атрибуты** - мб функция активации (не придумал пока оставать или отдать нейронам и забить), число нейронов в слое и сам вектор нейронов (или указателей на них)
- Сеть - класс. **Атрибуты**: вектор указателей на слои. тут методы для добавления слоя и т.д.
- Связи - не придумано. **Атрибуты**: вес (это и есть тренируемый параметр). Несложно разработать с учетом однонаправленности и связи типа "каждый с каждым"

Картинка разворачивается в вектор. Конфигурируется внешний слой. Пользователь добавляет внутренние слои, указывая их размерность и функции активации. Выходной слой использует softmax для классификации, по нему выбирается фигура. 

Изначально после создания модели все веса рандомные

## Обучение и хранение моделей
- В рассмотрении. Наиболее вероятный алгоритм - Back Propagation (метод обратного распространения ошибки)
- Размер батча и число эпох настраивает пользователь
#### Как работает
Последовательно выгружаются элементы обучающего датасета и "выпрямляются" в вектор. Пересчёт весов происходит после батча по алгоритму. Все это происходит число эпох раз.

#### Про хранение
Тут слабо проработано. Скорее всего следующим образом: модель обучилась, создается бинарник и в него "вписывается" таблица с описанием слоёв (число нейронов + функция активации), и массив весов. 
*В чём задача*: придумать формат+компилятор. onnx и какие-то прочие стандарты думаю использовать не будем. "Заточим" компилятор под свои полносвязные модели и мб оптимизируем из хранение

#### Про датасеты
Придумать алгоритм генерации изображений 28x28: точек, прямых, квадратов, кругов, треугольников и т.д. Собрать хотя бы 5000-6000 обучающих примеров и научиться выпрямлять их в вектор

Отдельный вопрос - тестовые датасеты. В общем, из можно взять и из предыдущего алгоритма

#### Про классификацию
Тут просто определиться с множеством геометрических примитивов, которые мы будем распознавать

## Что можно добавить
GUI для создания картинок. Как работает: пользователь что-то рисует и сеть в реальном времени выдает наиболее подходящий класс изображения (фигуру).

